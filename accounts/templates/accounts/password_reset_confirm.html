{% extends 'accounts/base_auth.html' %}

{% block title %}Set New Password{% endblock %}

{% block header %}
<h1>Set New Password</h1>
<p>Please enter your new password</p>
{% endblock %}

{% block content %}
<form method="post" novalidate>
    {% csrf_token %}
    
    <div class="form-group">
        <label for="{{ form.new_password1.id_for_label }}">New Password</label>
        {{ form.new_password1 }}
        {% if form.new_password1.errors %}
            <div class="invalid-feedback d-block">
                {{ form.new_password1.errors }}
            </div>
        {% endif %}
        <div class="password-requirements">
            <ul>
                <li id="length"><i class="fas fa-times"></i> At least 8 characters</li>
                <li id="uppercase"><i class="fas fa-times"></i> One uppercase letter</li>
                <li id="lowercase"><i class="fas fa-times"></i> One lowercase letter</li>
                <li id="number"><i class="fas fa-times"></i> One number</li>
                <li id="special"><i class="fas fa-times"></i> One special character</li>
            </ul>
        </div>
    </div>
    
    <div class="form-group">
        <label for="{{ form.new_password2.id_for_label }}">Confirm New Password</label>
        {{ form.new_password2 }}
        {% if form.new_password2.errors %}
            <div class="invalid-feedback d-block">
                {{ form.new_password2.errors }}
            </div>
        {% endif %}
    </div>
    
    <button type="submit" class="btn btn-primary w-100">Reset Password</button>
</form>
{% endblock %}

{% block footer %}
<p>Remember your password? <a href="{% url 'accounts:login' %}">Sign In</a></p>
{% endblock %}

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    const password = document.querySelector('#{{ form.new_password1.id_for_label }}');
    const requirements = {
        length: document.querySelector('#length'),
        uppercase: document.querySelector('#uppercase'),
        lowercase: document.querySelector('#lowercase'),
        number: document.querySelector('#number'),
        special: document.querySelector('#special')
    };
    
    password.addEventListener('input', function() {
        const value = this.value;
        
        // Check length
        if (value.length >= 8) {
            requirements.length.classList.add('valid');
            requirements.length.classList.remove('invalid');
            requirements.length.querySelector('i').className = 'fas fa-check';
        } else {
            requirements.length.classList.add('invalid');
            requirements.length.classList.remove('valid');
            requirements.length.querySelector('i').className = 'fas fa-times';
        }
        
        // Check uppercase
        if (/[A-Z]/.test(value)) {
            requirements.uppercase.classList.add('valid');
            requirements.uppercase.classList.remove('invalid');
            requirements.uppercase.querySelector('i').className = 'fas fa-check';
        } else {
            requirements.uppercase.classList.add('invalid');
            requirements.uppercase.classList.remove('valid');
            requirements.uppercase.querySelector('i').className = 'fas fa-times';
        }
        
        // Check lowercase
        if (/[a-z]/.test(value)) {
            requirements.lowercase.classList.add('valid');
            requirements.lowercase.classList.remove('invalid');
            requirements.lowercase.querySelector('i').className = 'fas fa-check';
        } else {
            requirements.lowercase.classList.add('invalid');
            requirements.lowercase.classList.remove('valid');
            requirements.lowercase.querySelector('i').className = 'fas fa-times';
        }
        
        // Check number
        if (/\d/.test(value)) {
            requirements.number.classList.add('valid');
            requirements.number.classList.remove('invalid');
            requirements.number.querySelector('i').className = 'fas fa-check';
        } else {
            requirements.number.classList.add('invalid');
            requirements.number.classList.remove('valid');
            requirements.number.querySelector('i').className = 'fas fa-times';
        }
        
        // Check special character
        if (/[!@#$%^&*(),.?":{}|<>]/.test(value)) {
            requirements.special.classList.add('valid');
            requirements.special.classList.remove('invalid');
            requirements.special.querySelector('i').className = 'fas fa-check';
        } else {
            requirements.special.classList.add('invalid');
            requirements.special.classList.remove('valid');
            requirements.special.querySelector('i').className = 'fas fa-times';
        }
    });
});
</script>
{% endblock %} 